#!/bin/sh

# SPDX-FileCopyrightText: 2023 Qusal contributors
#
# SPDX-License-Identifier: GPL-3.0-or-later

set -eu

die(){
  echo "error: $1" >&2
  exit 1
}

#origin="$QREXEC_REMOTE_DOMAIN"
agent="$QREXEC_SERVICE_ARGUMENT"
socket="/tmp/qubes-ssh-agent/${agent}.sock"

test -S "$socket" || die "Not a socket: $socket"

exec socat STDIO UNIX-CLIENT:"$socket"
